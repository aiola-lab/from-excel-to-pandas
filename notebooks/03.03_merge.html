

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Merge/Join Tables (VLOOKUP) &#8212; From Excel to Pandas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Split a Table into Groups" href="03.02_group_by.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">From Excel to Pandas</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to the complete tutorial from Excel to Pandas
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started.html">
   Install Locally
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started.html#open-in-binder-colab">
   Open in Binder/Colab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started.html#open-in-visual-studio-code">
   Open in Visual Studio Code
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Loading Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01%20-%20loading%20files.html">
   Loading Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.02%20-%20loading%20data%20from%20HTML.html">
   Reading Data from Web Sites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.03_loading_data_from_API.html">
   Reading Data from External API
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Adding Columns
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="02.01_Adding_New_Columns.html">
   Adding New Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.02_more_excel_functions.html">
   Adding Various Columns with Functions
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Table Aggregation and Reshaping
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="03.01_pivot_tables.html">
   Creating a Pivot Table
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03.02_group_by.html">
   Split a Table into Groups
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Table Enrichment with Merge
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Merge/Join Tables (VLOOKUP)
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/03.03_merge.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/notebooks/03.03_merge.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/notebooks/03.03_merge.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-lookup-data">
   Loading lookup data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lookup-data-exploration">
   Lookup Data Exploration
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#counting-values">
   Counting Values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-values">
   Sorting Values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualization-of-the-data">
   Visualization of the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#joining-the-tables">
   Joining the tables
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="merge-join-tables-vlookup">
<h1>Merge/Join Tables (VLOOKUP)<a class="headerlink" href="#merge-join-tables-vlookup" title="Permalink to this headline">¶</a></h1>
<p>The <em>merge</em> function mimics the functionality of JOIN in SQL queries and replaces the VLOOKUP functionality in Excel. It is one of the most powerful and useful functions for dataframes in Pandas. The main idea is to:</p>
<ul class="simple">
<li><p><strong>join</strong> two (or more) dataframe table using similar keys in each of the tables.</p></li>
<li><p><strong>enrich</strong> tables with loopup data</p></li>
<li><p><strong>validate</strong> the match values of the key columns in the tables</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="loading-lookup-data">
<h2>Loading lookup data<a class="headerlink" href="#loading-lookup-data" title="Permalink to this headline">¶</a></h2>
<p>For this example, we will take one of the common lookup data, zip code. The loopup is not trivial as there are a few tousands of values and a simple Excel file will struggle to do it efficently and quickly.</p>
<p>We will now start with loading the loopup data from <a class="reference external" href="https://simplemaps.com/data/us-zips">Simple Maps</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://mlguy-public.s3-eu-west-1.amazonaws.com/excel2pandas/chapter3/simplemaps_uszips_basicv1/uszips.csv&#39;</span>

<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">response</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Response [200]&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zip_lookup</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span>
    <span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mi">99611</span><span class="n">dc0ff32</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;df&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="lookup-data-exploration">
<h2>Lookup Data Exploration<a class="headerlink" href="#lookup-data-exploration" title="Permalink to this headline">¶</a></h2>
<p>The table above shows us the type of data that we can get from enrichment based on the zip code, including city, state, latitude, longitude, population and density.</p>
<p>We can explore the values that we have in this table, before we start to use it for enrichment.</p>
</div>
<div class="section" id="counting-values">
<h2>Counting Values<a class="headerlink" href="#counting-values" title="Permalink to this headline">¶</a></h2>
<p>The simplest aggregation function for each group is the <em>size</em>. How many zip codes do we have in each state?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">zip_lookup</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;state_name&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state_name
Alabama                  642
Alaska                   238
Arizona                  405
Arkansas                 591
California              1761
Colorado                 525
Connecticut              282
Delaware                  67
District of Columbia      52
Florida                  981
Georgia                  735
Hawaii                    94
Idaho                    277
Illinois                1383
Indiana                  775
Iowa                     934
Kansas                   697
Kentucky                 767
Louisiana                515
Maine                    432
Maryland                 468
Massachusetts            537
Michigan                 986
Minnesota                884
Mississippi              423
Missouri                1022
Montana                  361
Nebraska                 581
Nevada                   175
New Hampshire            248
New Jersey               595
New Mexico               368
New York                1794
North Carolina           808
North Dakota             383
Ohio                    1195
Oklahoma                 648
Oregon                   417
Pennsylvania            1795
Puerto Rico              131
Rhode Island              77
South Carolina           424
South Dakota             371
Tennessee                628
Texas                   1935
Utah                     287
Vermont                  255
Virginia                 896
Washington               596
West Virginia            706
Wisconsin                772
Wyoming                  178
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sorting-values">
<h2>Sorting Values<a class="headerlink" href="#sorting-values" title="Permalink to this headline">¶</a></h2>
<p>To sort the values is also simple with <em>sort_value()</em> function, and see the population size of each state (based on the zip code lookup data).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">zip_lookup</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;zip == 86403&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>zip</th>
      <th>lat</th>
      <th>lng</th>
      <th>city</th>
      <th>state_id</th>
      <th>state_name</th>
      <th>zcta</th>
      <th>parent_zcta</th>
      <th>population</th>
      <th>density</th>
      <th>county_fips</th>
      <th>county_name</th>
      <th>county_weights</th>
      <th>county_names_all</th>
      <th>county_fips_all</th>
      <th>imprecise</th>
      <th>military</th>
      <th>timezone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>29406</th>
      <td>86403</td>
      <td>34.48144</td>
      <td>-114.34829</td>
      <td>Lake Havasu City</td>
      <td>AZ</td>
      <td>Arizona</td>
      <td>True</td>
      <td>NaN</td>
      <td>18119</td>
      <td>608.9</td>
      <td>4015</td>
      <td>Mohave</td>
      <td>{'04015':100}</td>
      <td>Mohave</td>
      <td>04015</td>
      <td>False</td>
      <td>False</td>
      <td>America/Los_Angeles</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">us_population_distribution</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">zip_lookup</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;state_name&#39;</span><span class="p">)[</span><span class="s1">&#39;population&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">us_population_distribution</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state_name
California              39140219
Texas                   27884135
Florida                 20594164
New York                19618323
Illinois                12821487
Pennsylvania            12790950
Ohio                    11639989
Georgia                 10297534
North Carolina          10155624
Michigan                 9957465
New Jersey               8881845
Virginia                 8414042
Washington               7280023
Arizona                  6949259
Massachusetts            6830133
Tennessee                6644470
Indiana                  6637220
Missouri                 6090358
Maryland                 6003435
Wisconsin                5777892
Colorado                 5531233
Minnesota                5527473
South Carolina           4955925
Alabama                  4864630
Louisiana                4663243
Kentucky                 4446667
Oregon                   4081732
Oklahoma                 3918473
Connecticut              3581504
Puerto Rico              3384779
Iowa                     3133061
Utah                     3043806
Arkansas                 2990472
Mississippi              2988710
Nevada                   2923171
Kansas                   2908448
New Mexico               2089570
Nebraska                 1904901
West Virginia            1828786
Idaho                    1687214
Hawaii                   1422019
New Hampshire            1343673
Maine                    1332721
Rhode Island             1056611
Montana                  1042359
Delaware                  949495
South Dakota              864012
North Dakota              751250
Alaska                    737979
District of Columbia      684390
Vermont                   624977
Wyoming                   582091
Name: population, dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualization-of-the-data">
<h2>Visualization of the data<a class="headerlink" href="#visualization-of-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">us_population_distribution</span>
    <span class="o">.</span><span class="n">plot</span>
    <span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03.03_merge_12_0.svg" src="../_images/03.03_merge_12_0.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">breweries_data</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/us_breweries.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">breweries_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>brewery_type</th>
      <th>street</th>
      <th>address_2</th>
      <th>address_3</th>
      <th>city</th>
      <th>state</th>
      <th>county_province</th>
      <th>postal_code</th>
      <th>country</th>
      <th>longitude</th>
      <th>latitude</th>
      <th>phone</th>
      <th>website_url</th>
      <th>updated_at</th>
      <th>created_at</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Avondale Brewing Co</td>
      <td>micro</td>
      <td>201 41st St S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Birmingham</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>35222-1932</td>
      <td>United States</td>
      <td>-86.774322</td>
      <td>33.524521</td>
      <td>2.057775e+09</td>
      <td>http://www.avondalebrewing.com</td>
      <td>2018-08-23T23:19:57.825Z</td>
      <td>2018-07-24T01:32:47.255Z</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>Trim Tab Brewing</td>
      <td>micro</td>
      <td>2721 5th Ave S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Birmingham</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>35233-3401</td>
      <td>United States</td>
      <td>-86.791400</td>
      <td>33.512849</td>
      <td>2.057031e+09</td>
      <td>http://www.trimtabbrewing.com</td>
      <td>2018-08-23T23:20:31.423Z</td>
      <td>2018-07-24T01:32:47.815Z</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46</td>
      <td>Yellowhammer Brewery</td>
      <td>micro</td>
      <td>2600 Clinton Ave W</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Huntsville</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>35805-3046</td>
      <td>United States</td>
      <td>-86.593201</td>
      <td>34.727752</td>
      <td>2.569756e+09</td>
      <td>http://www.yellowhammerbrewery.com</td>
      <td>2018-08-23T23:20:33.102Z</td>
      <td>2018-07-24T01:32:47.838Z</td>
    </tr>
    <tr>
      <th>3</th>
      <td>55</td>
      <td>Bearpaw River Brewing Co</td>
      <td>micro</td>
      <td>4605 E Palmer Wasilla Hwy</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Wasilla</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>99654-7679</td>
      <td>United States</td>
      <td>-149.412710</td>
      <td>61.575269</td>
      <td>NaN</td>
      <td>http://bearpawriverbrewing.com</td>
      <td>2018-08-23T23:20:40.743Z</td>
      <td>2018-07-24T01:32:47.967Z</td>
    </tr>
    <tr>
      <th>4</th>
      <td>76</td>
      <td>King Street Brewing Co</td>
      <td>micro</td>
      <td>9050 King Street</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anchorage</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>99515</td>
      <td>United States</td>
      <td>-149.879076</td>
      <td>61.138489</td>
      <td>9.073365e+09</td>
      <td>http://www.kingstreetbrewing.com</td>
      <td>2018-08-23T23:20:57.179Z</td>
      <td>2018-07-24T01:32:48.301Z</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can see that the postal code is sometimes in the longer format compare to the zip codes that we have in our lookup table. We will convert them to the shorter format by taking the first 5 characters ([:5]) of the string of the postal_code column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">breweries_data_with_zip</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">breweries_data</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">zip_code</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">postal_code</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">breweries_data_with_zip</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>brewery_type</th>
      <th>street</th>
      <th>address_2</th>
      <th>address_3</th>
      <th>city</th>
      <th>state</th>
      <th>county_province</th>
      <th>postal_code</th>
      <th>country</th>
      <th>longitude</th>
      <th>latitude</th>
      <th>phone</th>
      <th>website_url</th>
      <th>updated_at</th>
      <th>created_at</th>
      <th>zip_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Avondale Brewing Co</td>
      <td>micro</td>
      <td>201 41st St S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Birmingham</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>35222-1932</td>
      <td>United States</td>
      <td>-86.774322</td>
      <td>33.524521</td>
      <td>2.057775e+09</td>
      <td>http://www.avondalebrewing.com</td>
      <td>2018-08-23T23:19:57.825Z</td>
      <td>2018-07-24T01:32:47.255Z</td>
      <td>35222</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>Trim Tab Brewing</td>
      <td>micro</td>
      <td>2721 5th Ave S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Birmingham</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>35233-3401</td>
      <td>United States</td>
      <td>-86.791400</td>
      <td>33.512849</td>
      <td>2.057031e+09</td>
      <td>http://www.trimtabbrewing.com</td>
      <td>2018-08-23T23:20:31.423Z</td>
      <td>2018-07-24T01:32:47.815Z</td>
      <td>35233</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46</td>
      <td>Yellowhammer Brewery</td>
      <td>micro</td>
      <td>2600 Clinton Ave W</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Huntsville</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>35805-3046</td>
      <td>United States</td>
      <td>-86.593201</td>
      <td>34.727752</td>
      <td>2.569756e+09</td>
      <td>http://www.yellowhammerbrewery.com</td>
      <td>2018-08-23T23:20:33.102Z</td>
      <td>2018-07-24T01:32:47.838Z</td>
      <td>35805</td>
    </tr>
    <tr>
      <th>3</th>
      <td>55</td>
      <td>Bearpaw River Brewing Co</td>
      <td>micro</td>
      <td>4605 E Palmer Wasilla Hwy</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Wasilla</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>99654-7679</td>
      <td>United States</td>
      <td>-149.412710</td>
      <td>61.575269</td>
      <td>NaN</td>
      <td>http://bearpawriverbrewing.com</td>
      <td>2018-08-23T23:20:40.743Z</td>
      <td>2018-07-24T01:32:47.967Z</td>
      <td>99654</td>
    </tr>
    <tr>
      <th>4</th>
      <td>76</td>
      <td>King Street Brewing Co</td>
      <td>micro</td>
      <td>9050 King Street</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anchorage</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>99515</td>
      <td>United States</td>
      <td>-149.879076</td>
      <td>61.138489</td>
      <td>9.073365e+09</td>
      <td>http://www.kingstreetbrewing.com</td>
      <td>2018-08-23T23:20:57.179Z</td>
      <td>2018-07-24T01:32:48.301Z</td>
      <td>99515</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="joining-the-tables">
<h2>Joining the tables<a class="headerlink" href="#joining-the-tables" title="Permalink to this headline">¶</a></h2>
<p>The joining of the table is based on a joined key. In this case we want to use the 5-digits zip code as the lookup or join key. In the previous step with shorten the longer zip codes to the shorter 5 digits format, and now we will make sure that the lookup table also have it in the same format. First we need to convert the numeric value into string (<em>astype(str)</em>), and then we will pad it with zero is the number is shorter than 5 digits (<em>zfill(5)</em>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zip_lookup_as_string</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">zip_lookup</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">zip_code</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">zip</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The join itself is simple. You start with the table that you want to enrich and using <em>merge</em>, you are joining it with the second table. In the example below both tables have a column with the same name (<em>zip_code</em>), and we use it using the <em>on</em> argument. Lastly, we want to have all breweries, even if we don’t find the zip code in the lookup table. Therefore, we are using <em>LEFT</em> join using the <em>how</em> argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">enriched_breweries_data</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">breweries_data_with_zip</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">zip_lookup_as_string</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;zip_code&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We have now many more columns as all the columns of both tables are joined to the enriched table. We will ask the Jupyter notebook to show us all the columns by removing the default maximum number of columns to display.</p>
<p>In the table below we can see all the columns. If the same column name is found in both tables and it wasn’t the column that was used for the join or merge, the column of first (“left”) table will be appended with x (<em>city_x</em>, for example), and the column of the second (“right”) table will be appended with y (<em>city_y</em>, for example).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">enriched_breweries_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>brewery_type</th>
      <th>street</th>
      <th>address_2</th>
      <th>address_3</th>
      <th>city_x</th>
      <th>state</th>
      <th>county_province</th>
      <th>postal_code</th>
      <th>country</th>
      <th>longitude</th>
      <th>latitude</th>
      <th>phone</th>
      <th>website_url</th>
      <th>updated_at</th>
      <th>created_at</th>
      <th>zip_code</th>
      <th>zip</th>
      <th>lat</th>
      <th>lng</th>
      <th>city_y</th>
      <th>state_id</th>
      <th>state_name</th>
      <th>zcta</th>
      <th>parent_zcta</th>
      <th>population</th>
      <th>density</th>
      <th>county_fips</th>
      <th>county_name</th>
      <th>county_weights</th>
      <th>county_names_all</th>
      <th>county_fips_all</th>
      <th>imprecise</th>
      <th>military</th>
      <th>timezone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Avondale Brewing Co</td>
      <td>micro</td>
      <td>201 41st St S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Birmingham</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>35222-1932</td>
      <td>United States</td>
      <td>-86.774322</td>
      <td>33.524521</td>
      <td>2.057775e+09</td>
      <td>http://www.avondalebrewing.com</td>
      <td>2018-08-23T23:19:57.825Z</td>
      <td>2018-07-24T01:32:47.255Z</td>
      <td>35222</td>
      <td>35222.0</td>
      <td>33.52409</td>
      <td>-86.77025</td>
      <td>Birmingham</td>
      <td>AL</td>
      <td>Alabama</td>
      <td>True</td>
      <td>NaN</td>
      <td>9033.0</td>
      <td>815.8</td>
      <td>1073.0</td>
      <td>Jefferson</td>
      <td>{'01073':100}</td>
      <td>Jefferson</td>
      <td>01073</td>
      <td>False</td>
      <td>False</td>
      <td>America/Chicago</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>Trim Tab Brewing</td>
      <td>micro</td>
      <td>2721 5th Ave S</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Birmingham</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>35233-3401</td>
      <td>United States</td>
      <td>-86.791400</td>
      <td>33.512849</td>
      <td>2.057031e+09</td>
      <td>http://www.trimtabbrewing.com</td>
      <td>2018-08-23T23:20:31.423Z</td>
      <td>2018-07-24T01:32:47.815Z</td>
      <td>35233</td>
      <td>35233.0</td>
      <td>33.50876</td>
      <td>-86.80194</td>
      <td>Birmingham</td>
      <td>AL</td>
      <td>Alabama</td>
      <td>True</td>
      <td>NaN</td>
      <td>1715.0</td>
      <td>300.7</td>
      <td>1073.0</td>
      <td>Jefferson</td>
      <td>{'01073':100}</td>
      <td>Jefferson</td>
      <td>01073</td>
      <td>False</td>
      <td>False</td>
      <td>America/Chicago</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46</td>
      <td>Yellowhammer Brewery</td>
      <td>micro</td>
      <td>2600 Clinton Ave W</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Huntsville</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>35805-3046</td>
      <td>United States</td>
      <td>-86.593201</td>
      <td>34.727752</td>
      <td>2.569756e+09</td>
      <td>http://www.yellowhammerbrewery.com</td>
      <td>2018-08-23T23:20:33.102Z</td>
      <td>2018-07-24T01:32:47.838Z</td>
      <td>35805</td>
      <td>35805.0</td>
      <td>34.70858</td>
      <td>-86.62125</td>
      <td>Huntsville</td>
      <td>AL</td>
      <td>Alabama</td>
      <td>True</td>
      <td>NaN</td>
      <td>21200.0</td>
      <td>949.7</td>
      <td>1089.0</td>
      <td>Madison</td>
      <td>{'01089':100}</td>
      <td>Madison</td>
      <td>01089</td>
      <td>False</td>
      <td>False</td>
      <td>America/Chicago</td>
    </tr>
    <tr>
      <th>3</th>
      <td>55</td>
      <td>Bearpaw River Brewing Co</td>
      <td>micro</td>
      <td>4605 E Palmer Wasilla Hwy</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Wasilla</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>99654-7679</td>
      <td>United States</td>
      <td>-149.412710</td>
      <td>61.575269</td>
      <td>NaN</td>
      <td>http://bearpawriverbrewing.com</td>
      <td>2018-08-23T23:20:40.743Z</td>
      <td>2018-07-24T01:32:47.967Z</td>
      <td>99654</td>
      <td>99654.0</td>
      <td>61.45483</td>
      <td>-149.90045</td>
      <td>Wasilla</td>
      <td>AK</td>
      <td>Alaska</td>
      <td>True</td>
      <td>NaN</td>
      <td>62135.0</td>
      <td>40.4</td>
      <td>2170.0</td>
      <td>Matanuska-Susitna</td>
      <td>{'02170':100}</td>
      <td>Matanuska-Susitna</td>
      <td>02170</td>
      <td>False</td>
      <td>False</td>
      <td>America/Anchorage</td>
    </tr>
    <tr>
      <th>4</th>
      <td>76</td>
      <td>King Street Brewing Co</td>
      <td>micro</td>
      <td>9050 King Street</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anchorage</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>99515</td>
      <td>United States</td>
      <td>-149.879076</td>
      <td>61.138489</td>
      <td>9.073365e+09</td>
      <td>http://www.kingstreetbrewing.com</td>
      <td>2018-08-23T23:20:57.179Z</td>
      <td>2018-07-24T01:32:48.301Z</td>
      <td>99515</td>
      <td>99515.0</td>
      <td>61.11739</td>
      <td>-149.88889</td>
      <td>Anchorage</td>
      <td>AK</td>
      <td>Alaska</td>
      <td>True</td>
      <td>NaN</td>
      <td>23402.0</td>
      <td>818.8</td>
      <td>2020.0</td>
      <td>Anchorage</td>
      <td>{'02020':100}</td>
      <td>Anchorage</td>
      <td>02020</td>
      <td>False</td>
      <td>False</td>
      <td>America/Anchorage</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>945</th>
      <td>195</td>
      <td>Sonoran Brewing</td>
      <td>contract</td>
      <td>3002 E Washington St</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Phoenix</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>85034-1518</td>
      <td>United States</td>
      <td>-111.980574</td>
      <td>33.447533</td>
      <td>6.025109e+09</td>
      <td>http://www.sonoranbrewing.com</td>
      <td>2018-08-23T23:22:39.673Z</td>
      <td>2018-07-24T01:32:49.957Z</td>
      <td>85034</td>
      <td>85034.0</td>
      <td>33.43489</td>
      <td>-112.02005</td>
      <td>Phoenix</td>
      <td>AZ</td>
      <td>Arizona</td>
      <td>True</td>
      <td>NaN</td>
      <td>4772.0</td>
      <td>188.7</td>
      <td>4013.0</td>
      <td>Maricopa</td>
      <td>{'04013':100}</td>
      <td>Maricopa</td>
      <td>04013</td>
      <td>False</td>
      <td>False</td>
      <td>America/Phoenix</td>
    </tr>
    <tr>
      <th>946</th>
      <td>196</td>
      <td>State 48 Barrel and Lager House</td>
      <td>planning</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Scottsdale</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>85260-1924</td>
      <td>United States</td>
      <td>-111.899237</td>
      <td>33.509121</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2018-08-23T23:22:40.070Z</td>
      <td>2018-07-24T01:32:49.969Z</td>
      <td>85260</td>
      <td>85260.0</td>
      <td>33.60958</td>
      <td>-111.89157</td>
      <td>Scottsdale</td>
      <td>AZ</td>
      <td>Arizona</td>
      <td>True</td>
      <td>NaN</td>
      <td>38934.0</td>
      <td>959.4</td>
      <td>4013.0</td>
      <td>Maricopa</td>
      <td>{'04013':100}</td>
      <td>Maricopa</td>
      <td>04013</td>
      <td>False</td>
      <td>False</td>
      <td>America/Phoenix</td>
    </tr>
    <tr>
      <th>947</th>
      <td>197</td>
      <td>State 48 Brewery</td>
      <td>planning</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Phoenix</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>85003-1626</td>
      <td>United States</td>
      <td>-112.077346</td>
      <td>33.448587</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2018-08-23T23:22:40.558Z</td>
      <td>2018-07-24T01:32:49.981Z</td>
      <td>85003</td>
      <td>85003.0</td>
      <td>33.45076</td>
      <td>-112.07836</td>
      <td>Phoenix</td>
      <td>AZ</td>
      <td>Arizona</td>
      <td>True</td>
      <td>NaN</td>
      <td>8419.0</td>
      <td>1953.9</td>
      <td>4013.0</td>
      <td>Maricopa</td>
      <td>{'04013':100}</td>
      <td>Maricopa</td>
      <td>04013</td>
      <td>False</td>
      <td>False</td>
      <td>America/Phoenix</td>
    </tr>
    <tr>
      <th>948</th>
      <td>199</td>
      <td>Sun Up Brewing Co.</td>
      <td>brewpub</td>
      <td>322 E Camelback Rd</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Phoenix</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>85012-1614</td>
      <td>United States</td>
      <td>-112.068777</td>
      <td>33.509509</td>
      <td>6.026709e+09</td>
      <td>http://sunup.beer</td>
      <td>2018-08-23T23:22:42.395Z</td>
      <td>2018-07-24T01:32:50.036Z</td>
      <td>85012</td>
      <td>85012.0</td>
      <td>33.50731</td>
      <td>-112.07035</td>
      <td>Phoenix</td>
      <td>AZ</td>
      <td>Arizona</td>
      <td>True</td>
      <td>NaN</td>
      <td>7012.0</td>
      <td>1124.4</td>
      <td>4013.0</td>
      <td>Maricopa</td>
      <td>{'04013':100}</td>
      <td>Maricopa</td>
      <td>04013</td>
      <td>False</td>
      <td>False</td>
      <td>America/Phoenix</td>
    </tr>
    <tr>
      <th>949</th>
      <td>200</td>
      <td>Sun Up Brewing Company 330</td>
      <td>planning</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Phoenix</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>85012</td>
      <td>United States</td>
      <td>-112.077346</td>
      <td>33.448587</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2018-08-23T23:22:42.843Z</td>
      <td>2018-07-24T01:32:50.050Z</td>
      <td>85012</td>
      <td>85012.0</td>
      <td>33.50731</td>
      <td>-112.07035</td>
      <td>Phoenix</td>
      <td>AZ</td>
      <td>Arizona</td>
      <td>True</td>
      <td>NaN</td>
      <td>7012.0</td>
      <td>1124.4</td>
      <td>4013.0</td>
      <td>Maricopa</td>
      <td>{'04013':100}</td>
      <td>Maricopa</td>
      <td>04013</td>
      <td>False</td>
      <td>False</td>
      <td>America/Phoenix</td>
    </tr>
  </tbody>
</table>
<p>950 rows × 36 columns</p>
</div></div></div>
</div>
<p>Now, that we have the enriched table, we can analyze the joined data and explore the different counties across the US, count their number of breweries, and check statistics about their population. It can help us decide where we should travel too, or where we should open the next brewry.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">enriched_breweries_data</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;county_name&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">agg</span><span class="p">(</span>
        <span class="n">state</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;state_id&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span> 
        <span class="n">brewry_count</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">),</span>
        <span class="n">population_sum</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="s1">&#39;sum&#39;</span><span class="p">),</span>
        <span class="n">density_average</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;population_sum&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>brewry_count</th>
      <th>population_sum</th>
      <th>density_average</th>
    </tr>
    <tr>
      <th>county_name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Maricopa</th>
      <td>AZ</td>
      <td>54</td>
      <td>2245381.0</td>
      <td>1384.942593</td>
    </tr>
    <tr>
      <th>Pima</th>
      <td>AZ</td>
      <td>17</td>
      <td>710693.0</td>
      <td>1314.441176</td>
    </tr>
    <tr>
      <th>San Diego</th>
      <td>CA</td>
      <td>16</td>
      <td>618653.0</td>
      <td>1358.225000</td>
    </tr>
    <tr>
      <th>Coconino</th>
      <td>AZ</td>
      <td>11</td>
      <td>404415.0</td>
      <td>15.054545</td>
    </tr>
    <tr>
      <th>Cook</th>
      <td>IL</td>
      <td>7</td>
      <td>352586.0</td>
      <td>3234.442857</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Humboldt</th>
      <td>CA</td>
      <td>1</td>
      <td>772.0</td>
      <td>12.400000</td>
    </tr>
    <tr>
      <th>Chemung</th>
      <td>NY</td>
      <td>1</td>
      <td>749.0</td>
      <td>21.000000</td>
    </tr>
    <tr>
      <th>Runnels</th>
      <td>TX</td>
      <td>1</td>
      <td>522.0</td>
      <td>2.400000</td>
    </tr>
    <tr>
      <th>San Juan</th>
      <td>CO</td>
      <td>1</td>
      <td>516.0</td>
      <td>0.800000</td>
    </tr>
    <tr>
      <th>Alamance</th>
      <td>NC</td>
      <td>1</td>
      <td>41.0</td>
      <td>819.900000</td>
    </tr>
  </tbody>
</table>
<p>367 rows × 4 columns</p>
</div></div></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="03.02_group_by.html" title="previous page">Split a Table into Groups</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Aiola Team<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>