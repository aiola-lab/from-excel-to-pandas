

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Split a Table into Groups &#8212; From Excel to Pandas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Merge/Join Tables (VLOOKUP)" href="03.03_merge.html" />
    <link rel="prev" title="Creating a Pivot Table" href="03.01_pivot_tables.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">From Excel to Pandas</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to the tutorial “from-Excel-to-Pandas” for data analysis
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started.html">
   Install Locally
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started.html#open-in-binder-colab">
   Open in Binder/Colab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started.html#open-in-visual-studio-code">
   Open in Visual Studio Code
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Loading Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="01%20-%20loading%20files.html">
   Loading Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.02%20-%20loading%20data%20from%20HTML.html">
   Reading Data from Web Sites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.03_loading_data_from_API.html">
   Reading Data from External API
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Adding Columns
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="02.01_Adding_New_Columns.html">
   Adding New Columns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02.02_date_functions.html">
   Date Functions
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Table Aggregation and Reshaping
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="03.01_pivot_tables.html">
   Creating a Pivot Table
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Split a Table into Groups
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Table Enrichment with Merge
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="03.03_merge.html">
   Merge/Join Tables (VLOOKUP)
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Industries Use Cases
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="08.01_Logistics_analysis.html">
   Logistics Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08.02_Currency_analysis.html">
   Currency
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08.03_Linear_optimization.html">
   Logistics Analysis
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/03.02_group_by.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://gesis.mybinder.org/binder/v2/gh/aiola-lab/from-excel-to-pandas//v2/gh/executablebooks/jupyter-book/master?urlpath=tree/notebooks/03.02_group_by.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/notebooks/03.02_group_by.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-data">
   Loading data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-all-pages">
   Loading all pages
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#saving-the-dataset">
     Saving the dataset
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#counting-values">
   Counting Values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sorting-values">
   Sorting Values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualization-of-the-data">
   Visualization of the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#more-advanced-aggregation-functions">
   More advanced Aggregation Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calclulating-mean">
   Calclulating mean
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#group-by-multiple-keys">
   Group by multiple keys
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advanced-group-functions">
   Advanced Group Functions
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="split-a-table-into-groups">
<h1>Split a Table into Groups<a class="headerlink" href="#split-a-table-into-groups" title="Permalink to this headline">¶</a></h1>
<p>The <em>groupby</em> function is one of the most powerful and useful functions for dataframes in Pandas. The main idea is to:</p>
<ul class="simple">
<li><p><strong>split</strong> a large dataframe table into groups based on some values or categories in some of the columns, and then</p></li>
<li><p><strong>apply</strong> some aggregation or other function on each group, and then</p></li>
<li><p><strong>combine</strong> them back together into a single table.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="loading-data">
<h2>Loading data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h2>
<p>We will now start with another data from API from an open source <a class="reference external" href="https://www.openbrewerydb.org/">brewery-DB API</a>. We can analyze it to answer questions regarding states or other groups in the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">open_brewery_api_url</span> <span class="o">=</span> <span class="s1">&#39;https://api.openbrewerydb.org/breweries?per_page=50&#39;</span>

<span class="kn">import</span> <span class="nn">requests</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">open_brewery_api_url</span><span class="p">)</span>
<span class="n">response</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Response [200]&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">brewery_list</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span>
    <span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
<span class="p">)</span>

<span class="n">brewery_list</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>brewery_type</th>
      <th>street</th>
      <th>address_2</th>
      <th>address_3</th>
      <th>city</th>
      <th>state</th>
      <th>county_province</th>
      <th>postal_code</th>
      <th>country</th>
      <th>longitude</th>
      <th>latitude</th>
      <th>phone</th>
      <th>website_url</th>
      <th>updated_at</th>
      <th>created_at</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>Avondale Brewing Co</td>
      <td>micro</td>
      <td>201 41st St S</td>
      <td>None</td>
      <td>None</td>
      <td>Birmingham</td>
      <td>Alabama</td>
      <td>None</td>
      <td>35222-1932</td>
      <td>United States</td>
      <td>-86.774322</td>
      <td>33.524521</td>
      <td>2057775456</td>
      <td>http://www.avondalebrewing.com</td>
      <td>2018-08-23T23:19:57.825Z</td>
      <td>2018-07-24T01:32:47.255Z</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>Trim Tab Brewing</td>
      <td>micro</td>
      <td>2721 5th Ave S</td>
      <td>None</td>
      <td>None</td>
      <td>Birmingham</td>
      <td>Alabama</td>
      <td>None</td>
      <td>35233-3401</td>
      <td>United States</td>
      <td>-86.7914000624146</td>
      <td>33.5128492349817</td>
      <td>2057030536</td>
      <td>http://www.trimtabbrewing.com</td>
      <td>2018-08-23T23:20:31.423Z</td>
      <td>2018-07-24T01:32:47.815Z</td>
    </tr>
    <tr>
      <th>2</th>
      <td>46</td>
      <td>Yellowhammer Brewery</td>
      <td>micro</td>
      <td>2600 Clinton Ave W</td>
      <td>None</td>
      <td>None</td>
      <td>Huntsville</td>
      <td>Alabama</td>
      <td>None</td>
      <td>35805-3046</td>
      <td>United States</td>
      <td>-86.5932014</td>
      <td>34.7277523</td>
      <td>2569755950</td>
      <td>http://www.yellowhammerbrewery.com</td>
      <td>2018-08-23T23:20:33.102Z</td>
      <td>2018-07-24T01:32:47.838Z</td>
    </tr>
    <tr>
      <th>3</th>
      <td>55</td>
      <td>Bearpaw River Brewing Co</td>
      <td>micro</td>
      <td>4605 E Palmer Wasilla Hwy</td>
      <td>None</td>
      <td>None</td>
      <td>Wasilla</td>
      <td>Alaska</td>
      <td>None</td>
      <td>99654-7679</td>
      <td>United States</td>
      <td>-149.4127103</td>
      <td>61.5752695</td>
      <td></td>
      <td>http://bearpawriverbrewing.com</td>
      <td>2018-08-23T23:20:40.743Z</td>
      <td>2018-07-24T01:32:47.967Z</td>
    </tr>
    <tr>
      <th>4</th>
      <td>76</td>
      <td>King Street Brewing Co</td>
      <td>micro</td>
      <td>9050 King Street</td>
      <td>None</td>
      <td>None</td>
      <td>Anchorage</td>
      <td>Alaska</td>
      <td>None</td>
      <td>99515</td>
      <td>United States</td>
      <td>-149.879076042937</td>
      <td>61.1384893547315</td>
      <td>9073365464</td>
      <td>http://www.kingstreetbrewing.com</td>
      <td>2018-08-23T23:20:57.179Z</td>
      <td>2018-07-24T01:32:48.301Z</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="loading-all-pages">
<h2>Loading all pages<a class="headerlink" href="#loading-all-pages" title="Permalink to this headline">¶</a></h2>
<p>If the number of results from an API is high, the API often uses pagination and returns a constant number of results in each page.</p>
<ul class="simple">
<li><p>Start with an empty list of values</p></li>
<li><p>For each page between page 1 and page 150:</p></li>
<li><p>Read the data from the API with the page number</p></li>
<li><p>Add the data to the growing list</p></li>
<li><p>Finally, create a dataframe with the above whole list of breweries</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">api_dataset</span> <span class="o">=</span> <span class="p">[]</span> 

<span class="c1">#looping through and putting data to the list api_dataset</span>
<span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">150</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">open_brewery_api_url</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;&amp;page=</span><span class="si">{</span><span class="n">page</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">api_dataset</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>

<span class="n">breweries_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">json_normalize</span><span class="p">(</span><span class="n">api_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="saving-the-dataset">
<h3>Saving the dataset<a class="headerlink" href="#saving-the-dataset" title="Permalink to this headline">¶</a></h3>
<p>We can save the dataset for later usage. We can save it in Excel format or CSV.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">breweries_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../data/us_breweries.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="counting-values">
<h2>Counting Values<a class="headerlink" href="#counting-values" title="Permalink to this headline">¶</a></h2>
<p>The simplest aggregation function for each group is the <em>size</em>. How many breweries do we have in each state?</p>
<ul class="simple">
<li><p>Start with the brewery table above</p></li>
<li><p>Group the rows by <em>state</em></p></li>
<li><p>Count the size of each group</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">breweries_data</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
Alabama                  46
Alaska                   45
Arizona                 126
Arkansas                 45
California              846
Colorado                407
Connecticut              84
Delaware                 28
District of Columbia     15
FL San                    1
Florida                 300
Georgia                 101
Hawaii                   20
Idaho                    58
Illinois                233
Indiana                 157
Iowa                     83
Kansas                   45
Kentucky                 55
Louisiana                40
Maine                   108
Maryland                105
Massachusetts           157
Michigan                352
Minnesota               169
Mississippi              15
Missouri                109
Montana                  86
Nebraska                 51
Nevada                   46
New Hampshire            65
New Jersey              112
New Mexico               77
New York                396
North Carolina          283
North Dakota             15
Ohio                    296
Oklahoma                 39
Oregon                  276
Pennsylvania            324
Rhode Island             22
South Carolina           72
South Dakota             25
Tennessee               107
Texas                   335
Utah                     40
Vermont                  57
Virginia                238
Washington              377
West Virginia            29
Wisconsin               195
Wyoming                  32
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sorting-values">
<h2>Sorting Values<a class="headerlink" href="#sorting-values" title="Permalink to this headline">¶</a></h2>
<p>To sort the values is also simple with <em>sort_value()</em> function</p>
<ul class="simple">
<li><p>Start with the brewery table above</p></li>
<li><p>Group the rows by <em>state</em></p></li>
<li><p>Count the size of each group</p></li>
<li><p>Sort the list of states and and the count of the breweries in descending order</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">breweries_data</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state
California              846
Colorado                407
New York                396
Washington              377
Michigan                352
Texas                   335
Pennsylvania            324
Florida                 300
Ohio                    296
North Carolina          283
Oregon                  276
Virginia                238
Illinois                233
Wisconsin               195
Minnesota               169
Indiana                 157
Massachusetts           157
Arizona                 126
New Jersey              112
Missouri                109
Maine                   108
Tennessee               107
Maryland                105
Georgia                 101
Montana                  86
Connecticut              84
Iowa                     83
New Mexico               77
South Carolina           72
New Hampshire            65
Idaho                    58
Vermont                  57
Kentucky                 55
Nebraska                 51
Nevada                   46
Alabama                  46
Kansas                   45
Arkansas                 45
Alaska                   45
Louisiana                40
Utah                     40
Oklahoma                 39
Wyoming                  32
West Virginia            29
Delaware                 28
South Dakota             25
Rhode Island             22
Hawaii                   20
District of Columbia     15
North Dakota             15
Mississippi              15
FL San                    1
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="visualization-of-the-data">
<h2>Visualization of the data<a class="headerlink" href="#visualization-of-the-data" title="Permalink to this headline">¶</a></h2>
<p>Let’s do a simple visualization of the data without any map, just using the longitude and latitude values of each brewery.</p>
<ul class="simple">
<li><p>Start with the brewery table above</p></li>
<li><p>Convert the longitude and latitude to be numeric values</p></li>
<li><p>Plot the results</p></li>
<li><p>as hexbin with longitude and latitudes as the coordinates</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">breweries_data</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">longitude</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">longitude</span><span class="p">))</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">latitude</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">latitude</span><span class="p">))</span>
    <span class="o">.</span><span class="n">plot</span>
    <span class="o">.</span><span class="n">hexbin</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span> 
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> 
        <span class="n">gridsize</span><span class="o">=</span><span class="mi">20</span>
    <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/03.02_group_by_14_0.png" src="../_images/03.02_group_by_14_0.png" />
</div>
</div>
<p>The graph above looks like the map of the US and the distribution of breweries in geographic terms. We can see the deep green in NY area which we already know that is third on the list of states (after the huge California and Colorado), but also see an even deeper blue area around Illinois. We will dive deeper into these questions, when we merge the zip code level with the data, and find the where should you live or visit if you want to taste as many breweries as possible.</p>
</div>
<div class="section" id="more-advanced-aggregation-functions">
<h2>More advanced Aggregation Functions<a class="headerlink" href="#more-advanced-aggregation-functions" title="Permalink to this headline">¶</a></h2>
<p>Our data set doesn’t have many numeric field, and we should load a different data set to examine the more advanced aggregation options of <em>groupby</em>. We will use one of the famouse data sets used for learning to build machine learning models. The last column <em>annual_income</em> has only two values <em>&lt;=50K</em> and <em>&gt;50K</em>, and we want to try and predict based on the other parameters such as age, gender, years of education, etc. in which bucket each person lands.</p>
<ul class="simple">
<li><p>Define the column names for the data</p></li>
<li><p>Read the CSV format of the data from the dataset URL</p></li>
<li><p>Set the names of the columns as defined above</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adult_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;education&#39;</span><span class="p">,</span><span class="s1">&#39;education_num&#39;</span><span class="p">,</span><span class="s1">&#39;marital_status&#39;</span><span class="p">,</span>
                <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span><span class="s1">&#39;race&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="s1">&#39;capital_gain&#39;</span><span class="p">,</span>
              <span class="s1">&#39;capital_loss&#39;</span><span class="p">,</span><span class="s1">&#39;hours_per_week&#39;</span><span class="p">,</span><span class="s1">&#39;native_country&#39;</span><span class="p">,</span><span class="s1">&#39;annual_income&#39;</span><span class="p">]</span>
<span class="n">adults_data</span> <span class="o">=</span> <span class="p">(</span>
  <span class="n">pd</span>
  <span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s1">&#39;https://archive.ics.uci.edu/ml/machine-learning-databases/adult/adult.data&#39;</span><span class="p">,</span> 
    <span class="n">names</span> <span class="o">=</span> <span class="n">adult_names</span>
  <span class="p">)</span>
<span class="p">)</span>
<span class="n">adults_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>id</th>
      <th>education</th>
      <th>education_num</th>
      <th>marital_status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>gender</th>
      <th>capital_gain</th>
      <th>capital_loss</th>
      <th>hours_per_week</th>
      <th>native_country</th>
      <th>annual_income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>39</td>
      <td>State-gov</td>
      <td>77516</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Never-married</td>
      <td>Adm-clerical</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>2174</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>Self-emp-not-inc</td>
      <td>83311</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Married-civ-spouse</td>
      <td>Exec-managerial</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>13</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>215646</td>
      <td>HS-grad</td>
      <td>9</td>
      <td>Divorced</td>
      <td>Handlers-cleaners</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>3</th>
      <td>53</td>
      <td>Private</td>
      <td>234721</td>
      <td>11th</td>
      <td>7</td>
      <td>Married-civ-spouse</td>
      <td>Handlers-cleaners</td>
      <td>Husband</td>
      <td>Black</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>4</th>
      <td>28</td>
      <td>Private</td>
      <td>338409</td>
      <td>Bachelors</td>
      <td>13</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Wife</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>Cuba</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>32556</th>
      <td>27</td>
      <td>Private</td>
      <td>257302</td>
      <td>Assoc-acdm</td>
      <td>12</td>
      <td>Married-civ-spouse</td>
      <td>Tech-support</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>38</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>32557</th>
      <td>40</td>
      <td>Private</td>
      <td>154374</td>
      <td>HS-grad</td>
      <td>9</td>
      <td>Married-civ-spouse</td>
      <td>Machine-op-inspct</td>
      <td>Husband</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;50K</td>
    </tr>
    <tr>
      <th>32558</th>
      <td>58</td>
      <td>Private</td>
      <td>151910</td>
      <td>HS-grad</td>
      <td>9</td>
      <td>Widowed</td>
      <td>Adm-clerical</td>
      <td>Unmarried</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>32559</th>
      <td>22</td>
      <td>Private</td>
      <td>201490</td>
      <td>HS-grad</td>
      <td>9</td>
      <td>Never-married</td>
      <td>Adm-clerical</td>
      <td>Own-child</td>
      <td>White</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>20</td>
      <td>United-States</td>
      <td>&lt;=50K</td>
    </tr>
    <tr>
      <th>32560</th>
      <td>52</td>
      <td>Self-emp-inc</td>
      <td>287927</td>
      <td>HS-grad</td>
      <td>9</td>
      <td>Married-civ-spouse</td>
      <td>Exec-managerial</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>15024</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;50K</td>
    </tr>
  </tbody>
</table>
<p>32561 rows × 15 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="calclulating-mean">
<h2>Calclulating mean<a class="headerlink" href="#calclulating-mean" title="Permalink to this headline">¶</a></h2>
<p>First we can calculate the average age in each income group, and see if there is any difference.</p>
<ul class="simple">
<li><p>Start with the adults data that was loaded above</p></li>
<li><p>Group using the <em>annual_income</em> value and take only the <em>age</em> value</p></li>
<li><p>Calculate the average of each group</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">adults_data</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;annual_income&#39;</span><span class="p">)[</span><span class="s1">&#39;age&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>annual_income
 &lt;=50K    36.783738
 &gt;50K     44.249841
Name: age, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can see that the average age of people who earned more than 50K is over 44, while the average age of the lower income (less than 50K) is younger and around 36 years</p>
</div>
<div class="section" id="group-by-multiple-keys">
<h2>Group by multiple keys<a class="headerlink" href="#group-by-multiple-keys" title="Permalink to this headline">¶</a></h2>
<p>Let’s see if women earn less than men, and we will do that by grouping both by the income group (<em>annual_income</em>) and the gender column.</p>
<ul class="simple">
<li><p>Start with the adults data that was loaded above</p></li>
<li><p>Group using the <em>annual_income</em> and the <em>gender</em> values</p></li>
<li><p>Calculate the size of each group</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">adults_data</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;annual_income&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>annual_income  gender 
 &lt;=50K          Female     9592
                Male      15128
 &gt;50K           Female     1179
                Male       6662
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>It is hard to calculate the percentage and evaluate the difference from the size of each group. Let’s calculate the percentage and also format the out to make it easier to read the results.</p>
<ul class="simple">
<li><p>Start with the adults data that was loaded above</p></li>
<li><p>Group using the <em>annual_income</em> and <em>gender</em> values and take only the <em>id</em> value</p></li>
<li><p>Calculate the size of each group</p></li>
<li><p>Group again by the first level (<em>annual_income</em>)</p></li>
<li><p>For each row in each group calculate the ratio of the size of the row with the total size of the group</p></li>
<li><p>Apply style to the results</p></li>
<li><p>Format the results as percentage with two digit precision.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">adults_data</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;annual_income&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">])[[</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span>
    <span class="o">.</span><span class="n">style</span>
    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2%}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
</style><table id="T_475ce5a8_66c0_11eb_a1f8_acde48001122" ><thead>    <tr>        <th class="blank" ></th>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >id</th>    </tr>    <tr>        <th class="index_name level0" >annual_income</th>        <th class="index_name level1" >gender</th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_475ce5a8_66c0_11eb_a1f8_acde48001122level0_row0" class="row_heading level0 row0" rowspan=2> <=50K</th>
                        <th id="T_475ce5a8_66c0_11eb_a1f8_acde48001122level1_row0" class="row_heading level1 row0" > Female</th>
                        <td id="T_475ce5a8_66c0_11eb_a1f8_acde48001122row0_col0" class="data row0 col0" >38.80%</td>
            </tr>
            <tr>
                                <th id="T_475ce5a8_66c0_11eb_a1f8_acde48001122level1_row1" class="row_heading level1 row1" > Male</th>
                        <td id="T_475ce5a8_66c0_11eb_a1f8_acde48001122row1_col0" class="data row1 col0" >61.20%</td>
            </tr>
            <tr>
                        <th id="T_475ce5a8_66c0_11eb_a1f8_acde48001122level0_row2" class="row_heading level0 row2" rowspan=2> >50K</th>
                        <th id="T_475ce5a8_66c0_11eb_a1f8_acde48001122level1_row2" class="row_heading level1 row2" > Female</th>
                        <td id="T_475ce5a8_66c0_11eb_a1f8_acde48001122row2_col0" class="data row2 col0" >15.04%</td>
            </tr>
            <tr>
                                <th id="T_475ce5a8_66c0_11eb_a1f8_acde48001122level1_row3" class="row_heading level1 row3" > Male</th>
                        <td id="T_475ce5a8_66c0_11eb_a1f8_acde48001122row3_col0" class="data row3 col0" >84.96%</td>
            </tr>
    </tbody></table></div></div>
</div>
<p>We can now easily see that the percentage of women with higher income is less than half that of the lower income. Hopefully, the current data (this data is extracted from the 1994 Census database) has improved the gender equlity in this aspect.</p>
</div>
<div class="section" id="advanced-group-functions">
<h2>Advanced Group Functions<a class="headerlink" href="#advanced-group-functions" title="Permalink to this headline">¶</a></h2>
<p>We saw before how to apply a function on each row in a dataframe table, but many times we want to apply a function on a group of rows based on a value of a column or a couple of columns.</p>
<p>We can also take each of the groups and calculate more advanced functions such as Correlation. Let’s see if we find Correlation with in each group between years of education and the number of work per week (which shows some quality of hard work)</p>
<ul class="simple">
<li><p>Start with the adults data that was loaded above</p></li>
<li><p>Take the <em>annual_income</em> and <em>gender</em> values with the <em>education_num</em> and <em>hours_per_week</em> values</p></li>
<li><p>Group by the <em>annual_income</em> and <em>gender</em> (and calculate the average of the other values in each group)</p></li>
<li><p>Calculate the Correlation of the values in each group</p></li>
<li><p>Replace the self-Correlation values of 1 with 0</p></li>
<li><p>Apply style to the results</p></li>
<li><p>Format the results with three digit precision.</p></li>
<li><p>Color the background of the cells according to the correlation values</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">adults_data</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;annual_income&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span><span class="s1">&#39;education_num&#39;</span><span class="p">,</span><span class="s1">&#39;hours_per_week&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;annual_income&#39;</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">])</span>
    <span class="o">.</span><span class="n">corr</span><span class="p">()</span>
    <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">style</span>
    <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.3}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style  type="text/css" >
#T_47601174_66c0_11eb_a1f8_acde48001122row0_col0,#T_47601174_66c0_11eb_a1f8_acde48001122row1_col1,#T_47601174_66c0_11eb_a1f8_acde48001122row2_col0,#T_47601174_66c0_11eb_a1f8_acde48001122row3_col1,#T_47601174_66c0_11eb_a1f8_acde48001122row4_col0,#T_47601174_66c0_11eb_a1f8_acde48001122row5_col1,#T_47601174_66c0_11eb_a1f8_acde48001122row6_col0,#T_47601174_66c0_11eb_a1f8_acde48001122row7_col1{
            background-color:  #3b4cc0;
            color:  #f1f1f1;
        }#T_47601174_66c0_11eb_a1f8_acde48001122row0_col1,#T_47601174_66c0_11eb_a1f8_acde48001122row1_col0{
            background-color:  #ec8165;
            color:  #000000;
        }#T_47601174_66c0_11eb_a1f8_acde48001122row2_col1,#T_47601174_66c0_11eb_a1f8_acde48001122row3_col0{
            background-color:  #b6cefa;
            color:  #000000;
        }#T_47601174_66c0_11eb_a1f8_acde48001122row4_col1,#T_47601174_66c0_11eb_a1f8_acde48001122row5_col0{
            background-color:  #b40426;
            color:  #f1f1f1;
        }#T_47601174_66c0_11eb_a1f8_acde48001122row6_col1,#T_47601174_66c0_11eb_a1f8_acde48001122row7_col0{
            background-color:  #8fb1fe;
            color:  #000000;
        }</style><table id="T_47601174_66c0_11eb_a1f8_acde48001122" ><thead>    <tr>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >education_num</th>        <th class="col_heading level0 col1" >hours_per_week</th>    </tr>    <tr>        <th class="index_name level0" >annual_income</th>        <th class="index_name level1" >gender</th>        <th class="index_name level2" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level0_row0" class="row_heading level0 row0" rowspan=4> <=50K</th>
                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level1_row0" class="row_heading level1 row0" rowspan=2> Female</th>
                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level2_row0" class="row_heading level2 row0" >education_num</th>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row0_col0" class="data row0 col0" >0.0</td>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row0_col1" class="data row0 col1" >0.151</td>
            </tr>
            <tr>
                                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level2_row1" class="row_heading level2 row1" >hours_per_week</th>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row1_col0" class="data row1 col0" >0.151</td>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row1_col1" class="data row1 col1" >0.0</td>
            </tr>
            <tr>
                                <th id="T_47601174_66c0_11eb_a1f8_acde48001122level1_row2" class="row_heading level1 row2" rowspan=2> Male</th>
                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level2_row2" class="row_heading level2 row2" >education_num</th>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row2_col0" class="data row2 col0" >0.0</td>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row2_col1" class="data row2 col1" >0.069</td>
            </tr>
            <tr>
                                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level2_row3" class="row_heading level2 row3" >hours_per_week</th>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row3_col0" class="data row3 col0" >0.069</td>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row3_col1" class="data row3 col1" >0.0</td>
            </tr>
            <tr>
                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level0_row4" class="row_heading level0 row4" rowspan=4> >50K</th>
                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level1_row4" class="row_heading level1 row4" rowspan=2> Female</th>
                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level2_row4" class="row_heading level2 row4" >education_num</th>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row4_col0" class="data row4 col0" >0.0</td>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row4_col1" class="data row4 col1" >0.187</td>
            </tr>
            <tr>
                                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level2_row5" class="row_heading level2 row5" >hours_per_week</th>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row5_col0" class="data row5 col0" >0.187</td>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row5_col1" class="data row5 col1" >0.0</td>
            </tr>
            <tr>
                                <th id="T_47601174_66c0_11eb_a1f8_acde48001122level1_row6" class="row_heading level1 row6" rowspan=2> Male</th>
                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level2_row6" class="row_heading level2 row6" >education_num</th>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row6_col0" class="data row6 col0" >0.0</td>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row6_col1" class="data row6 col1" >0.0477</td>
            </tr>
            <tr>
                                        <th id="T_47601174_66c0_11eb_a1f8_acde48001122level2_row7" class="row_heading level2 row7" >hours_per_week</th>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row7_col0" class="data row7 col0" >0.0477</td>
                        <td id="T_47601174_66c0_11eb_a1f8_acde48001122row7_col1" class="data row7 col1" >0.0</td>
            </tr>
    </tbody></table></div></div>
</div>
<p>We can see that within each group the correlation of “hard work”, as we defined it before, is higher for the female (0.151 and 0.187) than the male (0.069 and 0.0477).</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="03.01_pivot_tables.html" title="previous page">Creating a Pivot Table</a>
    <a class='right-next' id="next-link" href="03.03_merge.html" title="next page">Merge/Join Tables (VLOOKUP)</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Aiola Team<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>