

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Loading Files &#8212; From Excel to Pandas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reading Data from Web Sites" href="01.02%20-%20loading%20data%20from%20HTML.html" />
    <link rel="prev" title="Welcome to the complete tutorial from Excel to Pandas" href="../intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">From Excel to Pandas</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to the complete tutorial from Excel to Pandas
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Loading Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01.02%20-%20loading%20data%20from%20HTML.html">
   Reading Data from Web Sites
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/01 - loading files.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-csv-file">
   Loading CSV file
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-data-visualization">
   Simple data visualization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#adding-new-columns">
   Adding new columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-excel-files">
   Loading Excel Files
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="loading-files">
<h1>Loading Files<a class="headerlink" href="#loading-files" title="Permalink to this headline">¶</a></h1>
<p>In the first chapter we will learn how to load data into Pandas DataFrames. We will load multile formats of data sources including CSV files, Excel files, tables from web sites, tables in Databases, etc.</p>
<p>To make the notebooks cleaner and easier to read we will suppress warnings. Bad practice, however, OK for a tutorial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="loading-csv-file">
<h2>Loading CSV file<a class="headerlink" href="#loading-csv-file" title="Permalink to this headline">¶</a></h2>
<p>The comma-separated-values (CSV) format is one of the simplest and pupolar way to share (small) data. You can save an Excel files as CSV and it is the default format of many bulk download of data from databases and other sources.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
</pre></div>
</div>
</div>
</div>
<p>The first example is using data file about permits for restaurants in NY city. It was downloaded from the open data web site <a class="reference external" href="https://data.world/city-of-ny/pitm-atqc">data.world</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/open_restaurant_applications_1.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>objectid</th>
      <th>globalid</th>
      <th>seating_interest_sidewalk_roadway_both</th>
      <th>restaurant_name</th>
      <th>legal_business_name</th>
      <th>doing_business_as_dba</th>
      <th>bulding_number</th>
      <th>street</th>
      <th>borough</th>
      <th>postcode</th>
      <th>...</th>
      <th>time_of_submission</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>community_board</th>
      <th>council_district</th>
      <th>census_tract</th>
      <th>bin</th>
      <th>bbl</th>
      <th>nta</th>
      <th>location</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>32</td>
      <td>ae5914d4-6080-4144-8634-98ca22b215de</td>
      <td>sidewalk</td>
      <td>Arbuz Cafe</td>
      <td>Arbuz Cafe NY inc.</td>
      <td>Arbuz Cafe NY inc.</td>
      <td>1706</td>
      <td>Sheepshead Bay Rd</td>
      <td>Brooklyn</td>
      <td>11235</td>
      <td>...</td>
      <td>2020-06-19</td>
      <td>40.585724</td>
      <td>-73.951767</td>
      <td>315.0</td>
      <td>48.0</td>
      <td>606.0</td>
      <td>3343289.0</td>
      <td>3.087700e+09</td>
      <td>Sheepshead Bay-Gerritsen Beach-Manhattan Beach</td>
      <td>POINT(-73.951767 40.585724)</td>
    </tr>
    <tr>
      <th>1</th>
      <td>33</td>
      <td>81a2bad2-5bdc-49ed-8bb6-9dc3f9798732</td>
      <td>roadway</td>
      <td>Nerai</td>
      <td>Koureli Restaurant Group Inc</td>
      <td>Nerai</td>
      <td>55</td>
      <td>East 54th Street</td>
      <td>Manhattan</td>
      <td>10022</td>
      <td>...</td>
      <td>2020-06-19</td>
      <td>40.760117</td>
      <td>-73.973162</td>
      <td>105.0</td>
      <td>4.0</td>
      <td>102.0</td>
      <td>1035748.0</td>
      <td>1.012900e+09</td>
      <td>Midtown-Midtown South</td>
      <td>POINT(-73.973162 40.760117)</td>
    </tr>
    <tr>
      <th>2</th>
      <td>34</td>
      <td>b4bcb3a5-e2f7-4069-8c3b-21f47f051a63</td>
      <td>roadway</td>
      <td>Hill Country</td>
      <td>Hill Country New York, LLC</td>
      <td>Hill Country</td>
      <td>30</td>
      <td>West 26th</td>
      <td>Manhattan</td>
      <td>10010</td>
      <td>...</td>
      <td>2020-06-19</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35</td>
      <td>a1054682-ff93-4b07-8f99-daa2a7b0daaf</td>
      <td>both</td>
      <td>Sundays Well</td>
      <td>Two Bridge Tavern LLC</td>
      <td>Sundays Well</td>
      <td>360</td>
      <td>3rd Ave</td>
      <td>Manhattan</td>
      <td>10016</td>
      <td>...</td>
      <td>2020-06-19</td>
      <td>40.740892</td>
      <td>-73.981657</td>
      <td>106.0</td>
      <td>2.0</td>
      <td>68.0</td>
      <td>1018142.0</td>
      <td>1.008820e+09</td>
      <td>Gramercy</td>
      <td>POINT(-73.981657 40.740892)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>36</td>
      <td>1dd1f4e5-3e2c-4522-89e4-b3f4fc802436</td>
      <td>roadway</td>
      <td>Le Baba Cool, Inc</td>
      <td>Le Baba Cool, Inc</td>
      <td>Le Baba Cool, Inc</td>
      <td>64</td>
      <td>Lafayette AVe</td>
      <td>Brooklyn</td>
      <td>11217</td>
      <td>...</td>
      <td>2020-06-19</td>
      <td>40.687102</td>
      <td>-73.975365</td>
      <td>302.0</td>
      <td>35.0</td>
      <td>35.0</td>
      <td>3059298.0</td>
      <td>3.021160e+09</td>
      <td>Fort Greene</td>
      <td>POINT(-73.975365 40.687102)</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 36 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7939 entries, 0 to 7938
Data columns (total 36 columns):
 #   Column                                  Non-Null Count  Dtype  
---  ------                                  --------------  -----  
 0   objectid                                7939 non-null   int64  
 1   globalid                                7939 non-null   object 
 2   seating_interest_sidewalk_roadway_both  7939 non-null   object 
 3   restaurant_name                         7939 non-null   object 
 4   legal_business_name                     7938 non-null   object 
 5   doing_business_as_dba                   7929 non-null   object 
 6   bulding_number                          7939 non-null   object 
 7   street                                  7939 non-null   object 
 8   borough                                 7939 non-null   object 
 9   postcode                                7939 non-null   int64  
 10  business_address                        7939 non-null   object 
 11  food_service_establishment_permit       7935 non-null   object 
 12  sidewalk_dimensions_length              7120 non-null   float64
 13  sidewalk_dimensions_width               7120 non-null   float64
 14  sidewalk_dimensions_area                7120 non-null   float64
 15  roadway_dimensions_length               5080 non-null   float64
 16  roadway_dimensions_width                5080 non-null   float64
 17  roadway_dimensions_area                 5080 non-null   float64
 18  approved_for_sidewalk_seating           7939 non-null   object 
 19  approved_for_roadway_seating            7939 non-null   object 
 20  qualify_alcohol                         7939 non-null   object 
 21  sla_serial_number                       5774 non-null   object 
 22  sla_license_type                        5774 non-null   object 
 23  landmark_district_or_building           7939 non-null   object 
 24  landmarkdistrict_terms                  1210 non-null   object 
 25  healthcompliance_terms                  7939 non-null   object 
 26  time_of_submission                      7939 non-null   object 
 27  latitude                                6943 non-null   float64
 28  longitude                               6943 non-null   float64
 29  community_board                         6943 non-null   float64
 30  council_district                        6943 non-null   float64
 31  census_tract                            6943 non-null   float64
 32  bin                                     6888 non-null   float64
 33  bbl                                     6888 non-null   float64
 34  nta                                     6943 non-null   object 
 35  location                                6943 non-null   object 
dtypes: float64(13), int64(2), object(21)
memory usage: 2.2+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>objectid</th>
      <th>postcode</th>
      <th>sidewalk_dimensions_length</th>
      <th>sidewalk_dimensions_width</th>
      <th>sidewalk_dimensions_area</th>
      <th>roadway_dimensions_length</th>
      <th>roadway_dimensions_width</th>
      <th>roadway_dimensions_area</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>community_board</th>
      <th>council_district</th>
      <th>census_tract</th>
      <th>bin</th>
      <th>bbl</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>7939.000000</td>
      <td>7939.000000</td>
      <td>7120.000000</td>
      <td>7120.000000</td>
      <td>7120.000000</td>
      <td>5080.000000</td>
      <td>5080.000000</td>
      <td>5080.000000</td>
      <td>6943.000000</td>
      <td>6943.000000</td>
      <td>6943.000000</td>
      <td>6943.000000</td>
      <td>6943.000000</td>
      <td>6.888000e+03</td>
      <td>6.888000e+03</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>4006.485452</td>
      <td>10619.992442</td>
      <td>34.319101</td>
      <td>10.602247</td>
      <td>410.681882</td>
      <td>31.530709</td>
      <td>8.590945</td>
      <td>280.760236</td>
      <td>40.732316</td>
      <td>-73.952988</td>
      <td>231.494167</td>
      <td>17.970906</td>
      <td>3241.251476</td>
      <td>2.332593e+06</td>
      <td>2.277429e+09</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2297.885878</td>
      <td>1091.934677</td>
      <td>38.058425</td>
      <td>7.241442</td>
      <td>1109.156427</td>
      <td>30.240655</td>
      <td>4.384592</td>
      <td>513.508993</td>
      <td>0.057959</td>
      <td>0.061280</td>
      <td>128.857022</td>
      <td>15.370382</td>
      <td>13737.582279</td>
      <td>1.329363e+06</td>
      <td>1.296711e+09</td>
    </tr>
    <tr>
      <th>min</th>
      <td>32.000000</td>
      <td>7002.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>40.511019</td>
      <td>-74.248014</td>
      <td>101.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000e+06</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2016.500000</td>
      <td>10016.000000</td>
      <td>16.000000</td>
      <td>6.000000</td>
      <td>120.000000</td>
      <td>17.000000</td>
      <td>8.000000</td>
      <td>128.000000</td>
      <td>40.705540</td>
      <td>-73.990058</td>
      <td>105.000000</td>
      <td>3.000000</td>
      <td>70.000000</td>
      <td>1.026910e+06</td>
      <td>1.008740e+09</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>4005.000000</td>
      <td>10454.000000</td>
      <td>24.000000</td>
      <td>8.000000</td>
      <td>225.000000</td>
      <td>24.000000</td>
      <td>8.000000</td>
      <td>192.000000</td>
      <td>40.734268</td>
      <td>-73.968501</td>
      <td>208.000000</td>
      <td>15.000000</td>
      <td>151.000000</td>
      <td>2.046050e+06</td>
      <td>2.037640e+09</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>5993.500000</td>
      <td>11220.000000</td>
      <td>40.000000</td>
      <td>14.000000</td>
      <td>420.000000</td>
      <td>38.000000</td>
      <td>8.000000</td>
      <td>320.000000</td>
      <td>40.761935</td>
      <td>-73.922195</td>
      <td>314.000000</td>
      <td>33.000000</td>
      <td>483.500000</td>
      <td>3.335991e+06</td>
      <td>3.066340e+09</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7992.000000</td>
      <td>91206.000000</td>
      <td>1000.000000</td>
      <td>50.000000</td>
      <td>50000.000000</td>
      <td>1000.000000</td>
      <td>50.000000</td>
      <td>25000.000000</td>
      <td>40.911190</td>
      <td>-73.702668</td>
      <td>503.000000</td>
      <td>51.000000</td>
      <td>157903.000000</td>
      <td>5.169029e+06</td>
      <td>5.080430e+09</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="simple-data-visualization">
<h2>Simple data visualization<a class="headerlink" href="#simple-data-visualization" title="Permalink to this headline">¶</a></h2>
<p>As part of the data exploration phase, you want to look at the columns, a few rows (<em>head</em>), column statistics (<em>describe</em>), data types and number of values (<em>info</em>). However, usually the most effective way is to visualize the data to understand it.</p>
<p>In the next cell, we build a simple scatter plot of the data with <em>longitude</em> and <em>latitude</em> as x-axis and y-axis, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">table_df</span>
    <span class="o">.</span><span class="n">plot</span>
    <span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;longitude&#39;, ylabel=&#39;latitude&#39;&gt;
</pre></div>
</div>
<img alt="../_images/01 - loading files_11_1.png" src="../_images/01 - loading files_11_1.png" />
</div>
</div>
</div>
<div class="section" id="adding-new-columns">
<h2>Adding new columns<a class="headerlink" href="#adding-new-columns" title="Permalink to this headline">¶</a></h2>
<p>One of the most common tasks that we do when building an analysis is to add calcualted fields, based on the other columns in our table/DataFrame. We will discuss power of Pandas in adding new columns in the next sections of this guide. However, here is an example of calcuting the color of a data point, based on the value of <em>approved_for_roadway_seating</em> column. It will be green (<em>g</em>) if the value is <em>yes</em>, or red (<em>r</em>) otherwise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">table_df</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">approved</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">approved_for_roadway_seating</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;approved&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;longitude&#39;, ylabel=&#39;latitude&#39;&gt;
</pre></div>
</div>
<img alt="../_images/01 - loading files_13_1.png" src="../_images/01 - loading files_13_1.png" />
</div>
</div>
</div>
<div class="section" id="loading-excel-files">
<h2>Loading Excel Files<a class="headerlink" href="#loading-excel-files" title="Permalink to this headline">¶</a></h2>
<p>You can also read files that were edited in Excel and saved in the Excel format.</p>
<p>If the python environment that we are using is missing part of the needed functionality, such as the ability to parse the format of the Microsoft Excel files, we need to install using the following command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip3 install xlrd
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: pip is being invoked by an old script wrapper. This will fail in a future version of pip.
Please see https://github.com/pypa/pip/issues/5599 for advice on fixing the underlying issue.
To avoid this problem you can invoke Python with &#39;-m pip&#39; instead of running pip directly.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Defaulting to user installation because normal site-packages is not writeable
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: xlrd in /Users/guy/Library/Python/3.8/lib/python/site-packages (1.2.0)
</pre></div>
</div>
</div>
</div>
<p>Then, we can call <em>read_excel</em> instead of <em>read_csv</em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_df_from_excel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/open_restaurant_applications.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="n">d68f28157e0e</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">table_df_from_excel</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;../data/open_restaurant_applications.xlsx&#39;</span><span class="p">)</span>

<span class="nn">~/miniconda3/lib/python3.8/site-packages/pandas/util/_decorators.py</span> in <span class="ni">wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">294</span>                 <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">295</span>                 <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">FutureWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="n">stacklevel</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">296</span>             <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">297</span> 
<span class="g g-Whitespace">    </span><span class="mi">298</span>         <span class="k">return</span> <span class="n">wrapper</span>

<span class="nn">~/miniconda3/lib/python3.8/site-packages/pandas/io/excel/_base.py</span> in <span class="ni">read_excel</span><span class="nt">(io, sheet_name, header, names, index_col, usecols, squeeze, dtype, engine, converters, true_values, false_values, skiprows, nrows, na_values, keep_default_na, na_filter, verbose, parse_dates, date_parser, thousands, comment, skipfooter, convert_float, mangle_dupe_cols)</span>
<span class="g g-Whitespace">    </span><span class="mi">302</span> 
<span class="g g-Whitespace">    </span><span class="mi">303</span>     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">ExcelFile</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">304</span>         <span class="n">io</span> <span class="o">=</span> <span class="n">ExcelFile</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span>     <span class="k">elif</span> <span class="n">engine</span> <span class="ow">and</span> <span class="n">engine</span> <span class="o">!=</span> <span class="n">io</span><span class="o">.</span><span class="n">engine</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">306</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

<span class="nn">~/miniconda3/lib/python3.8/site-packages/pandas/io/excel/_base.py</span> in <span class="ni">__init__</span><span class="nt">(self, path_or_buffer, engine)</span>
<span class="g g-Whitespace">    </span><span class="mi">865</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_io</span> <span class="o">=</span> <span class="n">stringify_path</span><span class="p">(</span><span class="n">path_or_buffer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">866</span> 
<span class="ne">--&gt; </span><span class="mi">867</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engines</span><span class="p">[</span><span class="n">engine</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">_io</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> 
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="k">def</span> <span class="nf">__fspath__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">~/miniconda3/lib/python3.8/site-packages/pandas/io/excel/_xlrd.py</span> in <span class="ni">__init__</span><span class="nt">(self, filepath_or_buffer)</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">20</span><span class="s2">         err_msg = &quot;Install xlrd &gt;= 1.0.0 for Excel support&quot;</span>
<span class="ne">---&gt; </span><span class="mi">21</span><span class="s2">         import_optional_dependency(&quot;xlrd&quot;, extra=err_msg)</span>
<span class="g g-Whitespace">     </span><span class="mi">22</span><span class="s2">         super().__init__(filepath_or_buffer)</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span><span class="s2"> </span>

<span class="nn">~/miniconda3/lib/python3.8/site-packages/pandas/compat/_optional.py</span> in <span class="ni">import_optional_dependency</span><span class="nt">(name, extra, raise_on_missing, on_version)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span><span class="s2">     except ImportError:</span>
<span class="g g-Whitespace">    </span><span class="mi">109</span><span class="s2">         if raise_on_missing:</span>
<span class="ne">--&gt; </span><span class="mi">110</span><span class="s2">             raise ImportError(msg) from None</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span><span class="s2">         else:</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span><span class="s2">             return None</span>

<span class="ne">ImportError</span>: Missing optional dependency &#39;xlrd&#39;. Install xlrd &gt;= 1.0.0 for Excel support Use pip or conda to install xlrd.
</pre></div>
</div>
</div>
</div>
<p>and since the data now is in the Pandas (<em>pd</em>) DataFrame format, all the rest of the commands are exactly the same. For example, here is the same chart we plotted before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">table_df_from_excel</span>
    <span class="o">.</span><span class="n">plot</span>
    <span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;longitude&#39;, ylabel=&#39;latitude&#39;&gt;
</pre></div>
</div>
<img alt="../_images/01 - loading files_19_1.svg" src="../_images/01 - loading files_19_1.svg" /></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../intro.html" title="previous page">Welcome to the complete tutorial from Excel to Pandas</a>
    <a class='right-next' id="next-link" href="01.02%20-%20loading%20data%20from%20HTML.html" title="next page">Reading Data from Web Sites</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Aiola Team<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>